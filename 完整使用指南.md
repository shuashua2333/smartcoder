# 🚀 SmartCoder 完整使用指南

## 📁 项目结构

```
smartcoder/                    ← 主项目目录（yo code 创建的结构）
├── src/
│   └── extension.ts          ← 扩展主代码（已添加云端功能）
├── server/                   ← 后端服务器
│   ├── server.js
│   └── package.json
├── index.html                ← 网页前端
├── package.json              ← VS Code 扩展配置
├── tsconfig.json
└── .vscode/
    ├── launch.json           ← 调试配置
    └── tasks.json            ← 构建任务
```

---

## 📋 完整步骤（从头开始）

### 步骤 1: 打开项目

1. 打开 VS Code
2. 点击 `文件` → `打开文件夹`
3. 选择 `smartcoder` 文件夹（**不是** `smart` 根目录，而是 `smartcoder` 子文件夹）

---

### 步骤 2: 安装扩展依赖

在 VS Code 终端中（`` Ctrl+` ``），**确保在 `smartcoder` 目录下**运行：

```bash
npm install
```

这会安装：
- `axios` - HTTP 请求库
- `cheerio` - HTML 解析库  
- TypeScript 编译工具
- 其他开发依赖

**等待安装完成**（可能需要几分钟）

---

### 步骤 3: 编译扩展

在同一个终端中运行：

```bash
npm run compile
```

**成功输出**：
```
> smartcoder@0.0.1 compile
> tsc -p ./

# 没有错误说明编译成功
```

如果出现错误，检查：
- 是否在 `smartcoder` 目录下（不是 `smart` 根目录）
- 是否已运行 `npm install`

---

### 步骤 4: 配置 API Key

#### 4.1 在 VS Code 中配置

1. 按 `Ctrl + ,` 打开设置
2. 搜索 `smartcoder.apiKey`
3. 在输入框中填入你的 DeepSeek API Key（格式：`sk-xxxxx`）

**或者手动编辑设置文件**：
- Windows: `%APPDATA%\Code\User\settings.json`
- Mac: `~/Library/Application Support/Code/User/settings.json`
- Linux: `~/.config/Code/User/settings.json`

添加：
```json
{
  "smartcoder.apiKey": "sk-你的DeepSeek API Key"
}
```

#### 4.2 在网页中配置

1. 用文本编辑器打开 `smartcoder/index.html`
2. 找到这一行（约第 53 行）：
   ```javascript
   const DEEPSEEK_KEY = "sk-你的key";
   ```
3. 替换为你的实际 API Key：
   ```javascript
   const DEEPSEEK_KEY = "sk-你的实际DeepSeek API Key";
   ```

---

### 步骤 5: 启动后端服务器

**打开新的终端窗口**（保持扩展项目打开），运行：

```bash
cd smartcoder/server
npm install  # 如果还没安装
npm start
```

**看到这个输出说明成功**：
```
🚀 后端服务器启动: http://localhost:3000
```

**保持这个终端窗口打开！不要关闭！**

**注意**：
- `localhost:3000` 是 API 服务器，**不是网页**
- 不需要在浏览器中访问这个地址
- 如果访问显示错误，这是正常的

---

### 步骤 6: 启动扩展开发主机

1. **确保 VS Code 已打开 `smartcoder` 文件夹**
2. **确保已编译扩展**（步骤 3）
3. 按 `F5` 键启动扩展开发
4. 会打开一个新的 VS Code 窗口（标题显示 "Extension Development Host"）
5. **在这个新窗口中测试扩展**

---

### 步骤 7: 打开网页前端

1. 在文件管理器中找到 `smartcoder/index.html`
2. **双击打开**，或右键 → 打开方式 → 选择浏览器（Chrome/Edge/Firefox）
3. **不要**在地址栏输入 `localhost:3000`（那是 API 服务器）

---

### 步骤 8: 测试完整流程

现在你应该有：
- ✅ 后端服务器正在运行（步骤 5）
- ✅ 扩展开发主机窗口已打开（步骤 6）
- ✅ 浏览器已打开 `index.html`（步骤 7）

**开始测试：**

1. **在浏览器中**点击 **"🚀 在 VS Code 中编程"** 按钮

2. **扩展开发主机窗口应该自动**：
   - 打开 SmartCoder 侧边栏（左侧活动栏有机器人图标）
   - 显示云端状态栏（显示题目信息）
   - 自动创建一个代码文件
   - 显示"☁️ 提交到网页端"按钮

3. **在 VS Code 中**编写或修改代码

4. **点击侧边栏中的** **"☁️ 提交到网页端"** 按钮

5. **切换回浏览器**，查看 AI 导师的反馈

---

## 🔍 故障排查

### 问题 1: 按 F5 没反应

**检查清单：**
- [ ] 是否在 VS Code 中打开了 `smartcoder` 文件夹（不是 `smart` 根目录）
- [ ] 是否已运行 `npm install`
- [ ] 是否已运行 `npm run compile`
- [ ] 检查 `.vscode/launch.json` 文件是否存在

**解决**：确保在 `smartcoder` 目录下有 `.vscode` 文件夹和 `launch.json` 文件

### 问题 2: 编译错误

**常见错误**：
- `Cannot find module 'axios'` → 运行 `npm install`
- `Cannot find module 'cheerio'` → 运行 `npm install`
- 找不到 `smartcoder` 目录下的文件 → 确保在 `smartcoder` 目录下运行命令

### 问题 3: 点击按钮后 VS Code 没有反应

**检查清单：**
- [ ] 扩展是否已编译（`npm run compile`）
- [ ] 扩展开发主机是否已启动（按 F5）
- [ ] `index.html` 中的 `EXTENSION_ID` 是否正确（应该是 `smartcoder.smartcoder`）
- [ ] `package.json` 中是否有 `publisher` 字段

### 问题 4: 提交代码后网页没有收到

**检查清单：**
- [ ] 后端服务器是否正在运行（检查终端窗口）
- [ ] 浏览器控制台是否有错误（按 F12 打开开发者工具）
- [ ] 服务器是否在 `http://localhost:3000` 运行

### 问题 5: 提示需要 JDK

**通常不需要 JDK**！TypeScript/Node.js 扩展不需要 Java。

先尝试：
1. 直接按 `F5` 启动扩展
2. 如果正常运行，说明不需要 JDK
3. 如果报错，查看具体错误信息

如果真的需要（很少见），参考 `JDK安装说明.md`

---

## ✅ 快速检查清单

在测试前，确保：

- [ ] ✅ VS Code 已打开 `smartcoder` 文件夹
- [ ] ✅ 已运行 `npm install`（在 `smartcoder` 目录下）
- [ ] ✅ 已运行 `npm run compile`（在 `smartcoder` 目录下）
- [ ] ✅ 后端服务器正在运行（`cd smartcoder/server && npm start`）
- [ ] ✅ 已配置 API Key（VS Code 设置 + `index.html`）
- [ ] ✅ 扩展开发主机已启动（按 F5）
- [ ] ✅ 浏览器已打开 `index.html` 文件（不是访问 localhost:3000）

---

## 📝 命令速查

```bash
# 1. 安装扩展依赖（在 smartcoder 目录下）
cd smartcoder
npm install

# 2. 编译扩展（在 smartcoder 目录下）
npm run compile

# 3. 启动后端服务器（新终端，在 server 目录下）
cd smartcoder/server
npm install  # 如果还没安装
npm start

# 4. 启动扩展开发（在 VS Code 中按 F5）
# 或者使用命令面板：Ctrl+Shift+P → "Debug: Start Debugging"
```

---

## 🎉 完成！

如果所有步骤都正确，你现在可以：
- 从网页点击按钮唤起 VS Code
- 在 VS Code 中编写代码
- 提交代码到网页端
- 查看 AI 导师反馈

整个流程形成一个完整的闭环！

---

## 📚 相关文件

- `项目整合完成.md` - 项目整合说明
- `JDK安装说明.md` - 如果需要 JDK 的安装指南
- `扩展ID配置说明.md` - 扩展 ID 配置说明

