# 🔧 性能评测问题排查指南

## 常见问题：性能数据获取失败

如果看到 "⚠️ 性能数据获取失败"，请按照以下步骤排查：

### 1. 检查 .NET SDK 是否安装

**Windows:**
```powershell
dotnet --version
```

**如果显示错误：**
- 错误：`'dotnet' 不是内部或外部命令`
- 解决：需要安装 .NET SDK

**安装步骤：**
1. 访问：https://dotnet.microsoft.com/download
2. 下载 .NET SDK 6.0 或更高版本（推荐 8.0）
3. 运行安装程序
4. 重启 VS Code
5. 再次运行 `dotnet --version` 验证

### 2. 检查代码是否有语法错误

性能评测会先编译代码，如果代码有语法错误，会显示编译错误信息。

**常见编译错误：**
- 缺少分号 `;`
- 括号不匹配
- 类型错误
- 缺少 using 语句

**解决方法：**
- 检查 VS Code 中的错误提示
- 修复所有编译错误
- 重新提交

### 3. 检查代码是否包含 Main 方法

如果用户代码已经包含 `Main` 方法，可能会创建嵌套结构。

**建议：**
- 只写核心逻辑代码，不要包含 `Main` 方法
- 类似 LeetCode 的代码片段格式

**示例（正确）：**
```csharp
int[] nums = {2, 7, 11, 15};
int target = 9;
// 你的解题代码
```

**示例（不推荐）：**
```csharp
class Program {
    static void Main() {
        // 你的代码
    }
}
```

### 4. 检查运行超时

代码运行有 30 秒超时限制。

**如果代码运行时间过长：**
- 检查是否有无限循环
- 优化算法复杂度
- 减少数据规模

### 5. 查看详细错误信息

当性能数据获取失败时，扩展会显示详细的错误信息：

- **.NET SDK 未安装**：会提示安装链接
- **编译错误**：会显示具体的编译错误信息
- **运行错误**：会显示程序运行时的错误信息

### 6. 手动测试

如果问题持续，可以手动测试：

1. **创建测试项目：**
```bash
mkdir test-project
cd test-project
dotnet new console
```

2. **编写测试代码：**
```csharp
// Program.cs
using System;
using System.Diagnostics;

class Program
{
    static void Main()
    {
        var sw = Stopwatch.StartNew();
        long memoryBefore = GC.GetTotalMemory(false);
        
        // 你的代码
        Console.WriteLine("Hello World");
        
        sw.Stop();
        long memoryAfter = GC.GetTotalMemory(false);
        long memoryUsed = Math.Max(0, memoryAfter - memoryBefore);
        
        Console.WriteLine($"Runtime: {sw.ElapsedMilliseconds}ms");
        Console.WriteLine($"Memory: {memoryUsed} bytes");
    }
}
```

3. **运行测试：**
```bash
dotnet run
```

如果手动测试成功，但扩展中失败，可能是：
- 临时目录权限问题
- 路径问题（包含特殊字符）
- VS Code 扩展权限问题

### 7. 检查 VS Code 输出面板

1. 打开 VS Code
2. 按 `Ctrl+Shift+U` 打开输出面板
3. 选择 "Log (Extension Host)"
4. 查看是否有错误信息

### 8. 常见错误信息及解决方案

| 错误信息 | 原因 | 解决方案 |
|---------|------|---------|
| `dotnet command not found` | .NET SDK 未安装 | 安装 .NET SDK |
| `编译失败` | 代码有语法错误 | 修复代码错误 |
| `代码运行失败` | 运行时错误 | 检查代码逻辑 |
| `超时` | 代码运行超过 30 秒 | 优化算法或减少数据量 |
| `临时目录创建失败` | 权限问题 | 检查系统临时目录权限 |

### 9. 临时解决方案

如果性能评测一直失败，可以：

1. **跳过性能评测**：代码仍然会提交到云端，只是没有性能数据
2. **手动运行代码**：在 VS Code 终端中手动运行代码
3. **使用其他工具**：使用 Visual Studio 或其他 IDE 运行代码

### 10. 获取帮助

如果以上方法都无法解决问题：

1. 查看 VS Code 输出面板的详细错误信息
2. 检查系统日志
3. 提供以下信息：
   - 操作系统版本
   - .NET SDK 版本（`dotnet --version`）
   - VS Code 版本
   - 具体的错误信息
   - 代码示例（如果可能）

## ✅ 验证安装

运行以下命令验证环境：

```bash
# 检查 .NET SDK
dotnet --version

# 检查 Node.js
node --version

# 检查 npm
npm --version
```

所有命令都应该成功执行并显示版本号。

